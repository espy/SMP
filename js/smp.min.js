function initListeners(){getHashes();$(window).bind("statechange",function(e){getHashes();updateProjectGalleryNavigation();updateGallery()});$("img.lazy").each(function(){$(this).attr("src",$(this).data("src"))});$("ul.projectList:not(.index) li:not(.listTitle), ul.newsItems li a").hover(function(e){$(this).closest("ul").addClass("hover");e.preventDefault();var t=$(this).data("image");setBackgroundImage(t)},function(e){$(this).closest("ul").removeClass("hover");if($(this).closest("ul").hasClass("newsItems"))return;$("#backgroundImage").empty()});$(window).scroll(function(){$(window).scrollTop()>=$(window).height()-106?$(".projectSlider").addClass("fixedProjectSliderHeader"):$(".projectSlider").removeClass("fixedProjectSliderHeader")});$(".projectDescription").mouseenter(function(){var e=setTimeout(function(){openSlider()},250);$(this).data("descriptionDelay",e)});$(".projectDescription").mouseleave(function(){clearTimeout($(this).data("descriptionDelay"));closeSlider()});$("a.next, a.previous").click(function(e){e.preventDefault();History.pushState({},"",$(this).attr("href"))});$(document).keydown(function(e){switch(e.which){case 37:$("a.previous")[0].click();break;case 38:$(".projectDescription")&&openSlider();break;case 39:$(".nextProject.lastImageInGallery").length!==0?$(".nextProject.lastImageInGallery")[0].click():$("a.next")[0].click();break;case 40:$(".projectDescription")&&closeSlider();break;default:return}e.preventDefault()});$("a.anchor").click(function(e){e.preventDefault();var t=$("."+$(this).data("anchor")).offset().top-85;$.scrollTo(t,200,{axis:"y"});$(this).closest("ul").children("li").removeClass("current_page_item");$(this).closest("li").addClass("current_page_item");var n=_.first(hashes,2),r=root+"/"+n.concat($(this).data("anchor").toLowerCase()).join("/")+"/";History.pushState({},"",r)});$(".staffInfo a").hover(function(){$(this).closest(".staffRow").find(".staffImages li."+$(this).data("item")+" .overlay").addClass("hover")},function(){$(this).closest(".staffRow").find(".staffImages li."+$(this).data("item")+" .overlay").removeClass("hover")});$(".staffImages img, .staffImages .overlay").hover(function(){$(this).closest(".staffRow").find(".staffInfo li a."+$(this).parent().data("item")).addClass("hover")},function(){$(this).closest(".staffRow").find(".staffInfo li a."+$(this).parent().data("item")).removeClass("hover")});if($(".viewport.studio").length>0){$(".wrapper").mousemove(function(e){var t=e.pageX-$(this).offset().left,n=e.pageY-$(this).offset().top;if(t>columnWidth&&t<2*columnWidth){if(n>$("#backgroundImage").height()){$(".viewport.studio .showOnHover").addClass("isHovering");$(".viewport.studio .hideOnHover").addClass("isHovering")}}else if(!overrideStudioHover){$(".viewport.studio .showOnHover").removeClass("isHovering");$(".viewport.studio .hideOnHover").removeClass("isHovering")}});var e=_.throttle(onThrottleScroll,200);$(window).scroll(function(){e()})}$(".partners img").hover(function(){overrideStudioHover=!0;$(this).siblings("p.showOnHover").addClass("isHovering")},function(){overrideStudioHover=!1;$(this).siblings("p.showOnHover").removeClass("isHovering")});$(".viewport.press ul.newsItems a").click(function(e){e.preventDefault();$(".viewport>.newsItemView").remove();$(this).siblings(".newsItemView").clone().appendTo(".viewport");redrawLayout()});$(".viewport.press ul.newsItems a").mouseenter(function(e){e.preventDefault();$(".viewport>.newsItemView").remove();redrawLayout()});$(window).resize(function(){redrawLayout()});redrawLayout()}function onThrottleScroll(){var e=$(".section").index($(".viewport .section:in-viewport").last());$("#nav ul li").removeClass("current_page_item");var t=$("#nav ul li").eq(e);$(t).addClass("current_page_item");History.replaceState(null,null,$("a",t).attr("href"))}function openSlider(){if($(window).scrollTop()===0){var e=$(window).height()-106;lastSliderPosition&&(e=lastSliderPosition);$(document.body).animate({scrollTop:e},200);$.scrollTo(e,200,{axis:"y"})}}function closeSlider(){if($(window).scrollTop()>0){$(window).scrollTop()>$(window).height()-126?lastSliderPosition=$(window).scrollTop():lastSliderPosition=0;$.scrollTo(0,200,{axis:"y"})}}function showBGImage(){if($("#backgroundImage img").width()&&$("#backgroundImage img").width()!==0){scaleBGImage();$("#backgroundImage").fadeOut(0);$("#backgroundImage").css("visibility","visible");$("#backgroundImage").fadeIn(250)}else _.delay(function(){lazyBGImage()},100)}function setWidths(){if($(window).width()<=1200||$(window).height()<=700){wrapperMaxWidth=1024;viewportWidth=810;columnWidth=136;gutter=8}else{wrapperMaxWidth=1400;viewportWidth=1115;columnWidth=170;gutter=10}}function redrawLayout(){setWidths();lastSliderPosition=null;var e=$(window).height()-2*gutter,t=e+40,n=0,r=!1;$("ul.projectList.projects, ul.newsItems").each(function(e){var i=$(this).height();if(i!==undefined&&!$(this).data("original-height")&&i>0){$(this).data("original-height",i);r=!0;if($(this).data("original-height")>=t){t=i;n=100}else r=!0}});$("html.ie.lte9").each(function(){var e=($(window).width()-wrapperMaxWidth)/2;e<0&&(e=0);$(".wrapper").css("margin-left",e)});r&&$("ul.projectList.projects, ul.newsItems").height(t+n);if($(".viewport.press").length>0){var i=($(window).width()-wrapperMaxWidth)/2,s=wrapperMaxWidth+i;i<0&&(i=0);if(s>500){$(".wrapper").css({margin:"0 0 0 "+i+"px","max-width":s});$(".viewport").width(s-columnWidth)}$(".viewport>.newsItemView").css("height","auto");var o=$(".viewport>.newsItemView").outerHeight();if(o<$(window).height()-gutter){o=$(window).height()-gutter;$(".viewport>.newsItemView").css("height","100%")}o>$("ul.newsItems").height()?$("ul.newsItems").height(o):$(".viewport>.newsItemView").css("height","100%")}var u=$(".projectList.index:first-child").height();u!==0&&u<e&&$(".projectList.index:first-child").height(t-10);scaleBGImage();if($(".viewport.project, .viewport.projects, .viewport.index, .viewport.press").length>0){$(".viewport.project").height($(".projectDescription").height());$(".prevNavi, .nextNavi").height(e);$(".previous span, .next span").css("margin-top",e/2);$(".repeat span, .nextProject span").css("margin-top",e/4.4);$(".projectSlider").css("margin-top",$(window).height()-53-$(".projectSlider h1").height());var a=$(window).width()-($(window).width()-viewportWidth)/2-gutter;$("#backgroundImage, .nextNavi").css({right:gutter});$("#backgroundImage").css({width:a})}if($(".viewport.studio").length>0){var i=($(window).width()-wrapperMaxWidth)/2,s=wrapperMaxWidth+i;i<0&&(i=0);s>500&&$(".wrapper").css({margin:"0 0 0 "+i+"px","max-width":s});var f=$(window).height()-2*gutter;$(".previous span, .next span, .nextProject span").css("margin-top",f/2);$(".nextNavi").css({right:0})}if($(".viewport.press").length>0&&$(".viewport>.newsItemView").length>0){var o=$(".viewport>.newsItemView .description").offset().top+$(".viewport>.newsItemView .description").height();o>$(window).height()-50?$(".newsItemView").css("position","absolute"):$(".newsItemView").css("position","fixed")}$(".viewport.imprint").height($(window).height());$(".viewport, .columnsOverlay").css("background-position",$(".viewport").offset().left)}function scaleBGImage(){var e=$("#backgroundImage img")[0],t=$(window).width()-($("header").offset().left+$("header").width()+gutter),n;if($("#backgroundImage").hasClass("studio")){var r=$(window).height()-110;n=getFitAroundSizes($("#backgroundImage img"),t,r);if(!n){_.delay(function(){scaleBGImage()},500);return}$("#backgroundImage, #backgroundImage .columnsOverlay").height(r);$("#backgroundImage").width(t-30);$("#backgroundImage img").width(n[0]-30).height(n[1])}else{n=getFitAroundSizes($("#backgroundImage img"),t,$(window).height());if(!n){_.delay(function(){scaleBGImage()},500);return}$("#backgroundImage img").width(n[0]).height(n[1]);var i=t/2-n[0]/2,s=$(window).height()/2-n[1]/2;$("#backgroundImage img").css("margin-top",s);$("#backgroundImage img").css("margin-right",i)}}function updateProjectGalleryNavigation(){var e=_.last(hashes);e.length>2&&(e=0);var t;$(".viewport.studio").length>0?t=_.first(hashes,2):t=_.first(hashes,3);var n=$("#backgroundImage").data("gallery"),r=parseInt(e,10)+1;r>n.length&&(r=1);var i=parseInt(e,10)-1;i<=0&&(i=n.length);e==n.length?$(".nextNavi a").addClass("lastImageInGallery"):$(".nextNavi a").removeClass("lastImageInGallery");$("a.next").attr("href",root+"/"+t.concat(r).join("/")+"/");$("a.previous").attr("href",root+"/"+t.concat(i).join("/")+"/")}function updateGallery(){if(_.last(hashes).length>2)return;var e=parseInt(_.last(hashes),10)-1,t=$("#backgroundImage").data("gallery"),n=t[e].image.url;setBackgroundImage(n)}function setBackgroundImage(e){if($("#backgroundImage img").attr("src")==e)return;$("#backgroundImage img").remove();$("#backgroundImage").append('<img src="">');$("#backgroundImage").css("visibility","hidden");$("#backgroundImage").waitForImages(function(){lazyBGImage()});$("#backgroundImage img").attr("src",e)}function getFitAroundSizes(e,t,n){var r=1,i=1,s=1,o,u;if($(e).data("original-width")){o=$(e).data("original-width");u=$(e).data("original-height")}else{o=$(e).width();u=$(e).height();if(o<=100||u<=100)return null;$(e).data("original-width",o);$(e).data("original-height",u)}i=t/o;s=n/u;i>s?r=i:r=s;return[o*r,u*r]}function getHashes(){var e=History.getState(),t=e.url;hashes=e.hashedURL;var n=window.location.hostname;hashes=t.replace("http://","");hashes=hashes.replace(n+"/","").split("/");hashes=_.compact(hashes)}window.JSON||(window.JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)r=rep[n],typeof r=="string"&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){"use strict";var n=e.History=e.History||{},r=e.jQuery;if(typeof n.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");n.Adapter={bind:function(e,t,n){r(e).bind(t,n)},trigger:function(e,t,n){r(e).trigger(t,n)},extractEventData:function(e,n,r){var i=n&&n.originalEvent&&n.originalEvent[e]||r&&r[e]||t;return i},onDomLoad:function(e){r(e)}},typeof n.init!="undefined"&&n.init()}(window),function(e,t){"use strict";var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){if(typeof o.initHtml4.initialized!="undefined")return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=="undefined"?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t="",r,i,u,l;return o.isInternetExplorer()?(r="historyjs-iframe",i=n.createElement("iframe"),i.setAttribute("id",r),i.style.display="none",n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u="",l=!1,o.checkerFunction=function(){if(l)return!1;l=!0;var n=o.getHash()||"",r=o.unescapeHash(i.contentWindow.document.location.hash)||"";return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,"hashchange")):r!==u&&(u=r,o.setHash(r,!1)),l=!1,!0}):o.checkerFunction=function(){var n=o.getHash();return n!==t&&(t=n,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var r=t&&t.newURL||n.location.href,i=o.getHashByUrl(r),s=null,u=null,f=null,l;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(s=o.extractState(o.getFullUrl(i||n.location.href,!1),!0),o.isLastSavedState(s)?(o.busy(!1),!1):(u=o.getHashByState(s),l=o.discardedState(s),l?(o.getHashByIndex(-2)===o.getHashByState(l.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(s.data,s.title,s.url,!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(t,r,i,s){if(o.getHashByUrl(i))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(s!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:s}),!1;o.busy(!0);var u=o.createStateObject(t,r,i),f=o.getHashByState(u),l=o.getState(!1),h=o.getHashByState(l),p=o.getHash();return o.storeState(u),o.expectedStateId=u.id,o.recycleState(u),o.setTitle(u),f===h?(o.busy(!1),!1):f!==p&&f!==o.getShortUrl(n.location.href)?(o.setHash(f,!1),!1):(o.saveState(u),o.Adapter.trigger(e,"statechange"),o.busy(!1),!0)},o.replaceState=function(e,t,n,r){if(o.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:r}),!1;o.busy(!0);var i=o.createStateObject(e,t,n),s=o.getState(!1),u=o.getStateByIndex(-2);return o.discardState(s,i,u),o.pushState(i.data,i.title,i.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")})},typeof o.init!="undefined"&&o.init()}(window),function(e,t){"use strict";var n=e.console||t,r=e.document,i=e.navigator,s=e.sessionStorage||!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!="undefined")throw new Error("History.js Core has already been loaded...");h.init=function(){return typeof h.Adapter=="undefined"?!1:(typeof h.initCore!="undefined"&&h.initCore(),typeof h.initHtml4!="undefined"&&h.initHtml4(),!0)},h.initCore=function(){if(typeof h.initCore.initialized!="undefined")return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!="undefined"&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!="undefined"&&typeof n.log!="undefined"&&typeof n.log.apply!="undefined",t=r.getElementById("log"),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!="undefined"?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i="\n"+arguments[0]+"\n";for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=="object"&&typeof l!="undefined")try{a=l.stringify(a)}catch(f){}i+="\n"+a+"\n"}return t?(t.value+=i+"\n-----\n",t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!="undefined"?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement("div"),n=t.getElementsByTagName("i");while((t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!="undefined"?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=":"+r.location.port;return e+="/",e},h.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,n="";return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||r.location.href,n;return n=t.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+"/"}),n},h.getBasePageUrl=function(){var e=r.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=="undefined"?!0:t,/[a-z]+\:\/\//.test(e)||(r==="/"?n=h.getRootUrl()+e.replace(/^\/+/,""):r==="#"?n=h.getPageUrl().replace(/#.*/,"")+e:r==="?"?n=h.getPageUrl().replace(/[\?#].*/,"")+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,""):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(r,"/"),h.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),t},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=="undefined"&&(e=!0),typeof t=="undefined"&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!="undefined")t=h.stateToId[n];else if(typeof h.store.stateToId[n]!="undefined")t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof h.idToState[t]=="undefined"&&typeof h.store.idToState[t]=="undefined")break}h.stateToId[n]=t,h.idToState[t]=e}}return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!="object")e={};if(typeof e.normalized!="undefined")return e;if(!e.data||typeof e.data!="object")e.data={};t={},t.normalized=!0,t.title=e.title||"",t.url=h.getFullUrl(h.unescapeString(e.url||r.location.href)),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data);if(t.title||n)t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id;return t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r;return n=/(.*)\&_suid=([0-9]+)$/.exec(e),r=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=="undefined"?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getHash=function(){var e=h.unescapeHash(r.location.hash);return e},h.unescapeString=function(t){var n=t,r;for(;;){r=e.unescape(n);if(r===n)break;n=r}return n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=h.unescapeString(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},h.setHash=function(e,t){var n,i,s;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(n=h.escapeHash(e),h.busy(!0),i=h.extractState(e,!0),i&&!h.emulated.pushState?h.pushState(i.data,i.title,i.url,!1):r.location.hash!==n&&(h.bugs.setHash?(s=h.getPageUrl(),h.pushState(null,null,s+"#"+n,!1)):r.location.hash=n),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.escape(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(i){}return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!="undefined"?h.busy.flag=e:typeof h.busy.flag=="undefined"&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)}return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=="function"&&(e={callback:e}),typeof t!="undefined"&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(r.location.href),n;if(!h.isLastSavedState(t)){n=t;return n||(n=h.createStateObject()),h.Adapter.trigger(e,"popstate"),h}return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)h.back(t)}return h};if(h.emulated.pushState){var v=function(){};h.pushState=h.pushState||v,h.replaceState=h.replaceState||v}else h.onPopState=function(t,n){var i=!1,s=!1,o,u;return h.doubleCheckComplete(),o=h.getHash(),o?(u=h.extractState(o||r.location.href,!0),u?h.replaceState(u.data,u.title,u.url,!1):(h.Adapter.trigger(e,"anchorchange"),h.busy(!1)),h.expectedStateId=!1,!1):(i=h.Adapter.extractEventData("state",t,n)||!1,i?s=h.getStateById(i):h.expectedStateId?s=h.getStateById(h.expectedStateId):s=h.extractState(r.location.href),s||(s=h.createStateObject(null,null,r.location.href)),h.expectedStateId=!1,h.isLastSavedState(s)?(h.busy(!1),!1):(h.storeState(s),h.saveState(s),h.setTitle(s),h.Adapter.trigger(e,"statechange"),h.busy(!1),!0))},h.Adapter.bind(e,"popstate",h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,"popstate")),!0};if(s){try{h.store=l.parse(s.getItem("History.store"))||{}}catch(y){h.store={}}h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,"beforeunload",h.clearAllIntervals),h.Adapter.bind(e,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(r.location.href,!0))),s&&(h.onUnload=function(){var e,t;try{e=l.parse(s.getItem("History.store"))||{}}catch(n){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]}for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]}for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]}h.store=e,h.normalizeStore(),s.setItem("History.store",l.stringify(e))},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,"beforeunload",h.onUnload),h.Adapter.bind(e,"unload",h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==="Apple Computer, Inc."||(i.appCodeName||"")==="Mozilla")h.Adapter.bind(e,"hashchange",function(){h.Adapter.trigger(e,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,"hashchange")})}},h.init()}(window);(function(e){e.belowthefold=function(t,n){var r=e(window).height()+e(window).scrollTop();return r<=e(t).offset().top-n.threshold};e.abovethetop=function(t,n){var r=e(window).scrollTop();return r>=e(t).offset().top+e(t).height()-n.threshold};e.rightofscreen=function(t,n){var r=e(window).width()+e(window).scrollLeft();return r<=e(t).offset().left-n.threshold};e.leftofscreen=function(t,n){var r=e(window).scrollLeft();return r>=e(t).offset().left+e(t).width()-n.threshold};e.inviewport=function(t,n){return!e.rightofscreen(t,n)&&!e.leftofscreen(t,n)&&!e.belowthefold(t,n)&&!e.abovethetop(t,n)};e.extend(e.expr[":"],{"below-the-fold":function(t,n,r){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t,n,r){return e.abovethetop(t,{threshold:0})},"left-of-screen":function(t,n,r){return e.leftofscreen(t,{threshold:0})},"right-of-screen":function(t,n,r){return e.rightofscreen(t,{threshold:0})},"in-viewport":function(t,n,r){return e.inviewport(t,{threshold:0})}})})(jQuery);(function(e){var t="waitForImages";e.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};e.expr[":"].uncached=function(t){if(!e(t).is('img[src!=""]'))return!1;var n=new Image;n.src=t.src;return!n.complete};e.fn.waitForImages=function(n,r,i){var s=0,o=0;if(e.isPlainObject(arguments[0])){n=arguments[0].finished;r=arguments[0].each;i=arguments[0].waitForAll}n=n||e.noop;r=r||e.noop;i=!!i;if(!e.isFunction(n)||!e.isFunction(r))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var u=e(this),a=[],f=e.waitForImages.hasImageProperties||[],l=/url\(\s*(['"]?)(.*?)\1\s*\)/g;i?u.find("*").andSelf().each(function(){var t=e(this);t.is("img:uncached")&&a.push
({src:t.attr("src"),element:t[0]});e.each(f,function(e,n){var r=t.css(n),i;if(!r)return!0;while(i=l.exec(r))a.push({src:i[2],element:t[0]})})}):u.find("img:uncached").each(function(){a.push({src:this.src,element:this})});s=a.length;o=0;s===0&&n.call(u[0]);e.each(a,function(i,a){var f=new Image;e(f).bind("load."+t+" error."+t,function(e){o++;r.call(a.element,o,s,e.type=="load");if(o==s){n.call(u[0]);return!1}});f.src=a.src})})}})(jQuery);(function(){function C(e,t,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e._chain&&(e=e._wrapped);t._chain&&(t=t._wrapped);if(e.isEqual&&S.isFunction(e.isEqual))return e.isEqual(t);if(t.isEqual&&S.isFunction(t.isEqual))return t.isEqual(e);var r=a.call(e);if(r!=a.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var i=n.length;while(i--)if(n[i]==e)return!0;n.push(e);var s=0,o=!0;if(r=="[object Array]"){s=e.length;o=s==t.length;if(o)while(s--)if(!(o=s in e==s in t&&C(e[s],t[s],n)))break}else{if("constructor"in e!="constructor"in t||e.constructor!=t.constructor)return!1;for(var u in e)if(S.has(e,u)){s++;if(!(o=S.has(t,u)&&C(e[u],t[u],n)))break}if(o){for(u in t)if(S.has(t,u)&&!(s--))break;o=!s}}n.pop();return o}var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.slice,u=r.unshift,a=i.toString,f=i.hasOwnProperty,l=r.forEach,c=r.map,h=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,m=r.some,g=r.indexOf,y=r.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(e){return new P(e)};if(typeof exports!="undefined"){typeof module!="undefined"&&module.exports&&(exports=module.exports=S);exports._=S}else e._=S;S.VERSION="1.3.3";var x=S.each=S.forEach=function(e,t,r){if(e==null)return;if(l&&e.forEach===l)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i,e)===n)return}else for(var o in e)if(S.has(e,o)&&t.call(r,e[o],o,e)===n)return};S.map=S.collect=function(e,t,n){var r=[];if(e==null)return r;if(c&&e.map===c)return e.map(t,n);x(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)});e.length===+e.length&&(r.length=e.length);return r};S.reduce=S.foldl=S.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduce===h){r&&(t=S.bind(t,r));return i?e.reduce(t,n):e.reduce(t)}x(e,function(e,s,o){if(!i){n=e;i=!0}else n=t.call(r,n,e,s,o)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n};S.reduceRight=S.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduceRight===p){r&&(t=S.bind(t,r));return i?e.reduceRight(t,n):e.reduceRight(t)}var s=S.toArray(e).reverse();r&&!i&&(t=S.bind(t,r));return i?S.reduce(s,t,n,r):S.reduce(s,t)};S.find=S.detect=function(e,t,n){var r;T(e,function(e,i,s){if(t.call(n,e,i,s)){r=e;return!0}});return r};S.filter=S.select=function(e,t,n){var r=[];if(e==null)return r;if(d&&e.filter===d)return e.filter(t,n);x(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)});return r};S.reject=function(e,t,n){var r=[];if(e==null)return r;x(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)});return r};S.every=S.all=function(e,t,r){var i=!0;if(e==null)return i;if(v&&e.every===v)return e.every(t,r);x(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n});return!!i};var T=S.some=S.any=function(e,t,r){t||(t=S.identity);var i=!1;if(e==null)return i;if(m&&e.some===m)return e.some(t,r);x(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n});return!!i};S.include=S.contains=function(e,t){var n=!1;if(e==null)return n;if(g&&e.indexOf===g)return e.indexOf(t)!=-1;n=T(e,function(e){return e===t});return n};S.invoke=function(e,t){var n=o.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t||e:e[t]).apply(e,n)})};S.pluck=function(e,t){return S.map(e,function(e){return e[t]})};S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-Infinity;var r={computed:-Infinity};x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})});return r.value};S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return Infinity;var r={computed:Infinity};x(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})});return r.value};S.shuffle=function(e){var t=[],n;x(e,function(e,r,i){n=Math.floor(Math.random()*(r+1));t[r]=t[n];t[n]=e});return t};S.sortBy=function(e,t,n){var r=S.isFunction(t)?t:function(e){return e[t]};return S.pluck(S.map(e,function(e,t,i){return{value:e,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n===void 0?1:r===void 0?-1:n<r?-1:n>r?1:0}),"value")};S.groupBy=function(e,t){var n={},r=S.isFunction(t)?t:function(e){return e[t]};x(e,function(e,t){var i=r(e,t);(n[i]||(n[i]=[])).push(e)});return n};S.sortedIndex=function(e,t,n){n||(n=S.identity);var r=0,i=e.length;while(r<i){var s=r+i>>1;n(e[s])<n(t)?r=s+1:i=s}return r};S.toArray=function(e){return e?S.isArray(e)?o.call(e):S.isArguments(e)?o.call(e):e.toArray&&S.isFunction(e.toArray)?e.toArray():S.values(e):[]};S.size=function(e){return S.isArray(e)?e.length:S.keys(e).length};S.first=S.head=S.take=function(e,t,n){return t!=null&&!n?o.call(e,0,t):e[0]};S.initial=function(e,t,n){return o.call(e,0,e.length-(t==null||n?1:t))};S.last=function(e,t,n){return t!=null&&!n?o.call(e,Math.max(e.length-t,0)):e[e.length-1]};S.rest=S.tail=function(e,t,n){return o.call(e,t==null||n?1:t)};S.compact=function(e){return S.filter(e,function(e){return!!e})};S.flatten=function(e,t){return S.reduce(e,function(e,n){if(S.isArray(n))return e.concat(t?n:S.flatten(n));e[e.length]=n;return e},[])};S.without=function(e){return S.difference(e,o.call(arguments,1))};S.uniq=S.unique=function(e,t,n){var r=n?S.map(e,n):e,i=[];e.length<3&&(t=!0);S.reduce(r,function(n,r,s){if(t?S.last(n)!==r||!n.length:!S.include(n,r)){n.push(r);i.push(e[s])}return n},[]);return i};S.union=function(){return S.uniq(S.flatten(arguments,!0))};S.intersection=S.intersect=function(e){var t=o.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})};S.difference=function(e){var t=S.flatten(o.call(arguments,1),!0);return S.filter(e,function(e){return!S.include(t,e)})};S.zip=function(){var e=o.call(arguments),t=S.max(S.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=S.pluck(e,""+r);return n};S.indexOf=function(e,t,n){if(e==null)return-1;var r,i;if(n){r=S.sortedIndex(e,t);return e[r]===t?r:-1}if(g&&e.indexOf===g)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(r in e&&e[r]===t)return r;return-1};S.lastIndexOf=function(e,t){if(e==null)return-1;if(y&&e.lastIndexOf===y)return e.lastIndexOf(t);var n=e.length;while(n--)if(n in e&&e[n]===t)return n;return-1};S.range=function(e,t,n){if(arguments.length<=1){t=e||0;e=0}n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r){s[i++]=e;e+=n}return s};var N=function(){};S.bind=function(t,n){var r,i;if(t.bind===E&&E)return E.apply(t,o.call(arguments,1));if(!S.isFunction(t))throw new TypeError;i=o.call(arguments,2);return r=function(){if(this instanceof r){N.prototype=t.prototype;var e=new N,s=t.apply(e,i.concat(o.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(o.call(arguments)))}};S.bindAll=function(e){var t=o.call(arguments,1);t.length==0&&(t=S.functions(e));x(t,function(t){e[t]=S.bind(e[t],e)});return e};S.memoize=function(e,t){var n={};t||(t=S.identity);return function(){var r=t.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}};S.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)};S.defer=function(e){return S.delay.apply(S,[e,1].concat(o.call(arguments,1)))};S.throttle=function(e,t){var n,r,i,s,o,u,a=S.debounce(function(){o=s=!1},t);return function(){n=this;r=arguments;var f=function(){i=null;o&&e.apply(n,r);a()};i||(i=setTimeout(f,t));s?o=!0:u=e.apply(n,r);a();s=!0;return u}};S.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null;n||e.apply(i,s)};n&&!r&&e.apply(i,s);clearTimeout(r);r=setTimeout(o,t)}};S.once=function(e){var t=!1,n;return function(){if(t)return n;t=!0;return n=e.apply(this,arguments)}};S.wrap=function(e,t){return function(){var n=[e].concat(o.call(arguments,0));return t.apply(this,n)}};S.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}};S.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}};S.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t};S.values=function(e){return S.map(e,S.identity)};S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()};S.extend=function(e){x(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]});return e};S.pick=function(e){var t={};x(S.flatten(o.call(arguments,1)),function(n){n in e&&(t[n]=e[n])});return t};S.defaults=function(e){x(o.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])});return e};S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e};S.tap=function(e,t){t(e);return e};S.isEqual=function(e,t){return C(e,t,[])};S.isEmpty=function(e){if(e==null)return!0;if(S.isArray(e)||S.isString(e))return e.length===0;for(var t in e)if(S.has(e,t))return!1;return!0};S.isElement=function(e){return!!e&&e.nodeType==1};S.isArray=b||function(e){return a.call(e)=="[object Array]"};S.isObject=function(e){return e===Object(e)};S.isArguments=function(e){return a.call(e)=="[object Arguments]"};S.isArguments(arguments)||(S.isArguments=function(e){return!!e&&!!S.has(e,"callee")});S.isFunction=function(e){return a.call(e)=="[object Function]"};S.isString=function(e){return a.call(e)=="[object String]"};S.isNumber=function(e){return a.call(e)=="[object Number]"};S.isFinite=function(e){return S.isNumber(e)&&isFinite(e)};S.isNaN=function(e){return e!==e};S.isBoolean=function(e){return e===!0||e===!1||a.call(e)=="[object Boolean]"};S.isDate=function(e){return a.call(e)=="[object Date]"};S.isRegExp=function(e){return a.call(e)=="[object RegExp]"};S.isNull=function(e){return e===null};S.isUndefined=function(e){return e===void 0};S.has=function(e,t){return f.call(e,t)};S.noConflict=function(){e._=t;return this};S.identity=function(e){return e};S.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)};S.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};S.result=function(e,t){if(e==null)return null;var n=e[t];return S.isFunction(n)?n.call(e):n};S.mixin=function(e){x(S.functions(e),function(t){B(t,S[t]=e[t])})};var k=0;S.uniqueId=function(e){var t=k++;return e?e+t:t};S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/.^/,A={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var O in A)A[A[O]]=O;var M=/\\|'|\r|\n|\t|\u2028|\u2029/g,_=/\\(\\|'|r|n|t|u2028|u2029)/g,D=function(e){return e.replace(_,function(e,t){return A[t]})};S.template=function(e,t,n){n=S.defaults(n||{},S.templateSettings);var r="__p+='"+e.replace(M,function(e){return"\\"+A[e]}).replace(n.escape||L,function(e,t){return"'+\n_.escape("+D(t)+")+\n'"}).replace(n.interpolate||L,function(e,t){return"'+\n("+D(t)+")+\n'"}).replace(n.evaluate||L,function(e,t){return"';\n"+D(t)+"\n;__p+='"})+"';\n";n.variable||(r="with(obj||{}){\n"+r+"}\n");r="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+r+"return __p;\n";var i=new Function(n.variable||"obj","_",r);if(t)return i(t,S);var s=function(e){return i.call(this,e,S)};s.source="function("+(n.variable||"obj")+"){\n"+r+"}";return s};S.chain=function(e){return S(e).chain()};var P=function(e){this._wrapped=e};S.prototype=P.prototype;var H=function(e,t){return t?S(e).chain():e},B=function(e,t){P.prototype[e]=function(){var e=o.call(arguments);u.call(e,this._wrapped);return H(t.apply(S,e),this._chain)}};S.mixin(S);x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];P.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);var r=n.length;(e=="shift"||e=="splice")&&r===0&&delete n[0];return H(n,this._chain)}});x(["concat","join","slice"],function(e){var t=r[e];P.prototype[e]=function(){return H(t.apply(this._wrapped,arguments),this._chain)}});P.prototype.chain=function(){this._chain=!0;return this};P.prototype.value=function(){return this._wrapped}}).call(this);var lazyBGImage,lastSliderPosition,hashes,wrapperMaxWidth,viewportWidth,columnWidth,gutter,overrideStudioHover=!1;$(window).ready(function(){lazyBGImage=_.debounce(showBGImage,100);initListeners()});$(window).load(function(){$("body").fadeOut().css("display","block");redrawLayout();$("body").fadeIn(250);if(typeof scrollToSection!="undefined"&&scrollToSection!==""){var e=$("."+scrollToSection).offset().top-85;$.scrollTo(e,250,{axis:"y"})}$(".projectList .project").each(function(){var e=$(this).data("image");$(".cache").append('<img src="'+e+'"/>')});_.delay(function(){$("img.lazy").each(function(){$(this).attr("src",$(this).data("src"))})},300)});